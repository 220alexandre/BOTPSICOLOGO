{% extends "base.html" %} {% block title %}Chat{% endblock %} {% block content
%}
<h1>Chat</h1>
<div id="chatbox">
  <div id="messages"></div>
  <div>
    <input type="text" id="userInput" placeholder="Digite sua mensagem" />
    <button onclick="sendMessage()">Enviar</button>
  </div>
</div>
<script>
  async function sendMessage() {
    const userInput = document.getElementById("userInput").value;
    const messagesDiv = document.getElementById("messages");

    // Exibindo a mensagem do usuário
    const userMessageDiv = document.createElement("div");
    userMessageDiv.textContent = `Você: ${userInput}`;
    messagesDiv.appendChild(userMessageDiv);

    // Enviando a mensagem para o backend
    const response = await fetch("/chat", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ message: userInput }),
    });

    const data = await response.json();

    if (data.error) {
      alert(data.error);
    } else {
      // Exibindo a resposta do bot
      const botMessageDiv = document.createElement("div");
      botMessageDiv.textContent = `Bot: ${data.response}`;
      messagesDiv.appendChild(botMessageDiv);

      // Limpando o campo de entrada
      document.getElementById("userInput").value = "";

      // Rolando para a última mensagem
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
  }
</script>
{% endblock %}
